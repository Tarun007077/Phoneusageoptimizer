# Cell 1 — Load dataset
from google.colab import files

local_path_1 = '/mnt/data/rl_mobile_usage_dataset_with_states.csv'
uploaded = None
df = None

# Try loading from /mnt/data first
if os.path.exists(local_path_1):
    df = pd.read_csv(local_path_1)
    print("Loaded dataset from", local_path_1)
else:
    print("Dataset not found in /mnt/data. Please upload the CSV file via dialog.")
    uploaded = files.upload()
    if uploaded:
        fname = list(uploaded.keys())[0]
        df = pd.read_csv(fname)
        print("Loaded uploaded file:", fname)

print('\nDataset shape:', df.shape)
display(df.head())
# Cell 2 — Preprocessing

import pandas as pd
from sklearn.preprocessing import LabelEncoder, StandardScaler

# Make a copy of the dataset
df_copy = df.copy()

# Ensure required columns exist
required_cols = [
    "Age",
    "Daily_Screen_Time_Hours",
    "Social_Media_Usage_Hours",
    "Gaming_Usage_Hours",
    "Entertainment_Apps_Hours",
    "Productivity_Apps_Hours",
    "Other_Apps_Hours",
    "time_of_day",
    "day_of_week",
    "past_7day_avg_unproductive_hours",
    "session_length_minutes",
    "self_reported_satisfaction"
]

missing = [c for c in required_cols if c not in df_copy.columns]
if missing:
    raise ValueError("Missing columns in dataset: " + ", ".join(missing))

# Encode categorical features
enc_time = LabelEncoder()
df_copy["time_of_day_enc"] = enc_time.fit_transform(df_copy["time_of_day"])

enc_day = LabelEncoder()
df_copy["day_of_week_enc"] = enc_day.fit_transform(df_copy["day_of_week"])

# Feature list
features = [
    "Age",
    "Daily_Screen_Time_Hours",
    "Social_Media_Usage_Hours",
    "Gaming_Usage_Hours",
    "Entertainment_Apps_Hours",
    "Productivity_Apps_Hours",
    "Other_Apps_Hours",
    "time_of_day_enc",
    "day_of_week_enc",
    "past_7day_avg_unproductive_hours",
    "session_length_minutes",
    "self_reported_satisfaction"
]

# Feature matrix
X = df_copy[features].copy()

# Standardize features
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X).astype("float32")

print("Prepared feature matrix X_scaled with shape:", X_scaled.shape)

# Preview scaled features
display(pd.DataFrame(X_scaled, columns=features).head())
